"use strict";(self.webpackChunkpk_connect=self.webpackChunkpk_connect||[]).push([[234],{234:(e,n,t)=>{t.r(n),t.d(n,{mountElement:()=>x});var c=t(271),o=t.n(c),r=t(650),a=t.n(r),s=t(577),l=t(934),u=t(861),i=t(885),p=t(757),m=t.n(p),h=t(788),d=t.n(h),f=t(379),k=t.n(f),v=t(279);function g(){var e=localStorage.getItem("token"),n=(0,c.useState)(e&&JSON.parse(e).value),t=(0,i.Z)(n,2),r=t[0],a=t[1],s=!1;return(0,c.useEffect)((0,u.Z)(m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch("https://pk-center.herokuapp.com/auth/reconnect",{method:"POST",headers:{Authorization:"Bearer ".concat(r)}}).then((function(e){if(e.status>=400&&e.status<600)throw new Error("Bad response from server");return e})).catch((function(e){localStorage.removeItem("token"),a(null)}));case 4:case"end":return e.stop()}}),e)}))),[]),o().createElement(o().Fragment,null,r&&o().createElement("div",{className:"pkc-status"},"connected"),!r&&o().createElement("div",{className:"pkc-modal"},o().createElement("div",{className:"pkc-modal-overlay"}),o().createElement("div",{className:"pkc-modal-content"},o().createElement("button",{onClick:function(){s||(s=!0,fetch("https://pk-center.herokuapp.com/auth/guest",{method:"POST"}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("token",JSON.stringify({value:e.access_token})),a(e.access_token)})).finally((function(){s=!1})))}},"Play as guest"),o().createElement("button",{onClick:function(){location.href="https://pk.land/#/account/login"}},"Login PK account"))))}k()(v.Z,{insert:"head",singleton:!1}),v.Z.locals,(0,s.Z)({seed:"pk-connect",productionPrefix:"pk-connect"});var E=d()({React:o(),ReactDOM:a(),rootComponent:g,errorBoundary:function(e,n,t){return o().createElement("div",null,"This renders when a catastrophic error occurs")}}),b=(E.bootstrap,E.mount,E.unmount,(0,s.Z)({productionPrefix:"pk-connect"}));const w=function(){return o().createElement("div",null,o().createElement(l.ZP,{generateClassName:b},o().createElement(g,null)))};var x=function(e){a().render(o().createElement(w,null),e)}},279:(e,n,t)=>{t.d(n,{Z:()=>s});var c=t(81),o=t.n(c),r=t(645),a=t.n(r)()(o());a.push([e.id,".pkc-status {\n  color: lime;\n}\n.pkc-modal {\n  position: fixed;\n  z-index: 500;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.pkc-modal-overlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n}\n.pkc-modal-content {\n  width: 300px;\n  height: 200px;\n}\n",""]);const s=a}}]);