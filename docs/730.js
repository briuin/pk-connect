"use strict";(self.webpackChunkpk_connect=self.webpackChunkpk_connect||[]).push([[730],{730:(n,t,e)=>{e.r(t),e.d(t,{mountElement:()=>j});var r=e(271),a=e.n(r),c=e(650),i=e.n(c),o=e(577),s=e(985),l=e(861),p=e(885),h=e(757),u=e.n(h),m=e(788),d=e.n(m),v=e(379),b=e.n(v),f=e(279);b()(f.Z,{insert:"head",singleton:!1}),f.Z.locals;var y=e(191),g=e.n(y),k=e(671),x=e(144),w=e(942),_=e(213),E=e.n(_),S=e(529),C=function(){function n(){(0,k.Z)(this,n),(0,w.Z)(this,"isConnecting",!1),(0,w.Z)(this,"socket",null),(0,w.Z)(this,"user",{username:""}),(0,w.Z)(this,"isAuthenticatedSubject",new S.BehaviorSubject(!1)),(0,w.Z)(this,"isAuthenticated$",this.isAuthenticatedSubject.asObservable())}return(0,x.Z)(n,[{key:"isConnected",value:function(){return this.socket&&this.socket.connected||!1}},{key:"isAuthenticated",value:function(){return this.user&&this.user.username}},{key:"logout",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{redirectToHomepage:!0};localStorage.removeItem("token"),this.user={},this.isAuthenticatedSubject.next(!1),n.redirectToHomepage&&(location.href="/")}},{key:"setUser",value:function(n){this.user=n,this.isAuthenticatedSubject.next(!0),this.socket&&this.socket.emit("updateUserInfo",{username:n.username})}},{key:"init",value:function(n){if(!this.isConnecting&&!this.socket){var t=localStorage.getItem("token"),e=t&&JSON.parse(t).value;this.socket=E()(n,{withCredentials:!0,transportOptions:{polling:{extraHeaders:{Authorization:"Bearer ".concat(e)}}}}),this.isConnecting=!0,this.socket.on("connect",this.onConnect)}}},{key:"onConnect",value:function(n){this.isConnecting=!1,console.log("connected")}}]),n}();const Z=new C;function z(){var n=localStorage.getItem("token"),t=(0,r.useState)(n&&JSON.parse(n).value),e=(0,p.Z)(t,2),c=e[0],i=e[1],o=!1;return(0,r.useEffect)((0,l.Z)(u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,fetch("https://pk-center.herokuapp.com/auth/reconnect",{method:"POST",headers:{Authorization:"Bearer ".concat(c)}}).then((function(n){if(n.status>=400&&n.status<600)throw new Error("Bad response from server");return Z.setUser(g()(c)),n})).catch((function(n){localStorage.removeItem("token"),i(null)}));case 4:case"end":return n.stop()}}),n)}))),[]),a().createElement(a().Fragment,null,c&&a().createElement("div",{className:"pkc-status"},"connected"),!c&&a().createElement("div",{className:"pkc-modal"},a().createElement("div",{className:"pkc-modal-overlay"}),a().createElement("div",{className:"pkc-modal-content"},a().createElement("button",{className:"cybr-btn",onClick:function(){o||(o=!0,fetch("https://pk-center.herokuapp.com/auth/guest",{method:"POST"}).then((function(n){return n.json()})).then((function(n){localStorage.setItem("token",JSON.stringify({value:n.access_token})),i(n.access_token),Z.setUser(g()(n.access_token))})).finally((function(){o=!1})))}},"Guest",a().createElement("span",{"aria-hidden":!0},"_"),a().createElement("span",{"aria-hidden":!0,class:"cybr-btn__glitch"},"Guest_"),a().createElement("span",{"aria-hidden":!0,class:"cybr-btn__tag"},"PK")),a().createElement("button",{className:"cybr-btn",onClick:function(){location.href="https://pk.land/#/account/login"}}," ","Login",a().createElement("span",{"aria-hidden":!0},"_"),a().createElement("span",{"aria-hidden":!0,class:"cybr-btn__glitch"},"Login_"),a().createElement("span",{"aria-hidden":!0,class:"cybr-btn__tag"},"PK")))))}(0,o.Z)({seed:"pk-connect",productionPrefix:"pk-connect"});var N=d()({React:a(),ReactDOM:i(),rootComponent:z,errorBoundary:function(n,t,e){return a().createElement("div",null,"This renders when a catastrophic error occurs")}}),A=(N.bootstrap,N.mount,N.unmount,(0,o.Z)({productionPrefix:"pk-connect"}));const O=function(){return a().createElement("div",null,a().createElement(s.ZP,{generateClassName:A},a().createElement(z,null)))};var j=function(n){i().render(a().createElement(O,null),n)}},279:(n,t,e)=>{e.d(t,{Z:()=>o});var r=e(81),a=e.n(r),c=e(645),i=e.n(c)()(a());i.push([n.id,'.pkc-status {\n  color: lime;\n}\n.pkc-modal {\n  position: fixed;\n  z-index: 500;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.pkc-modal-overlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background: rgba(255, 255, 0, 0.5);\n}\n.pkc-modal-content {\n  z-index: 1;\n  width: 300px;\n  height: 200px;\n}\n\nbody .cybr-btn + .cybr-btn {\n  margin-top: 2rem;\n}\n\n.cybr-btn {\n  --primary: hsl(\n    var(--primary-hue),\n    85%,\n    calc(var(--primary-lightness, 50) * 1%)\n  );\n  --shadow-primary: hsl(var(--shadow-primary-hue), 90%, 50%);\n  --primary-hue: 0;\n  --primary-lightness: 50;\n  --color: hsl(0, 0%, 100%);\n  --font-size: 26px;\n  --shadow-primary-hue: 180;\n  --label-size: 9px;\n  --shadow-secondary-hue: 60;\n  --shadow-secondary: hsl(var(--shadow-secondary-hue), 90%, 60%);\n  --clip: polygon(\n    0 0,\n    100% 0,\n    100% 100%,\n    95% 100%,\n    95% 90%,\n    85% 90%,\n    85% 100%,\n    8% 100%,\n    0 70%\n  );\n  --border: 4px;\n  --shimmy-distance: 5;\n  --clip-one: polygon(\n    0 2%,\n    100% 2%,\n    100% 95%,\n    95% 95%,\n    95% 90%,\n    85% 90%,\n    85% 95%,\n    8% 95%,\n    0 70%\n  );\n  --clip-two: polygon(\n    0 78%,\n    100% 78%,\n    100% 100%,\n    95% 100%,\n    95% 90%,\n    85% 90%,\n    85% 100%,\n    8% 100%,\n    0 78%\n  );\n  --clip-three: polygon(\n    0 44%,\n    100% 44%,\n    100% 54%,\n    95% 54%,\n    95% 54%,\n    85% 54%,\n    85% 54%,\n    8% 54%,\n    0 54%\n  );\n  --clip-four: polygon(\n    0 0,\n    100% 0,\n    100% 0,\n    95% 0,\n    95% 0,\n    85% 0,\n    85% 0,\n    8% 0,\n    0 0\n  );\n  --clip-five: polygon(\n    0 0,\n    100% 0,\n    100% 0,\n    95% 0,\n    95% 0,\n    85% 0,\n    85% 0,\n    8% 0,\n    0 0\n  );\n  --clip-six: polygon(\n    0 40%,\n    100% 40%,\n    100% 85%,\n    95% 85%,\n    95% 85%,\n    85% 85%,\n    85% 85%,\n    8% 85%,\n    0 70%\n  );\n  --clip-seven: polygon(\n    0 63%,\n    100% 63%,\n    100% 80%,\n    95% 80%,\n    95% 80%,\n    85% 80%,\n    85% 80%,\n    8% 80%,\n    0 70%\n  );\n  font-family: "Cyber", sans-serif;\n  color: var(--color);\n  cursor: pointer;\n  background: transparent;\n  text-transform: uppercase;\n  font-size: var(--font-size);\n  outline: transparent;\n  letter-spacing: 2px;\n  position: relative;\n  font-weight: 700;\n  border: 0;\n  min-width: 300px;\n  height: 75px;\n  line-height: 75px;\n  transition: background 0.2s;\n}\n\n.cybr-btn:hover {\n  --primary: hsl(\n    var(--primary-hue),\n    85%,\n    calc(var(--primary-lightness, 50) * 0.8%)\n  );\n}\n.cybr-btn:active {\n  --primary: hsl(\n    var(--primary-hue),\n    85%,\n    calc(var(--primary-lightness, 50) * 0.6%)\n  );\n}\n\n.cybr-btn:after,\n.cybr-btn:before {\n  content: "";\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  clip-path: var(--clip);\n  z-index: -1;\n}\n\n.cybr-btn:before {\n  background: var(--shadow-primary);\n  transform: translate(var(--border), 0);\n}\n\n.cybr-btn:after {\n  background: var(--primary);\n}\n\n.cybr-btn__tag {\n  position: absolute;\n  padding: 1px 4px;\n  letter-spacing: 1px;\n  line-height: 1;\n  bottom: -5%;\n  right: 5%;\n  font-weight: normal;\n  color: hsl(0, 0%, 0%);\n  font-size: var(--label-size);\n}\n\n.cybr-btn__glitch {\n  position: absolute;\n  top: calc(var(--border) * -1);\n  left: calc(var(--border) * -1);\n  right: calc(var(--border) * -1);\n  bottom: calc(var(--border) * -1);\n  background: var(--shadow-primary);\n  text-shadow: 2px 2px var(--shadow-primary), -2px -2px var(--shadow-secondary);\n  clip-path: var(--clip);\n  animation: glitch 2s infinite;\n  display: none;\n}\n\n.cybr-btn:hover .cybr-btn__glitch {\n  display: block;\n}\n\n.cybr-btn__glitch:before {\n  content: "";\n  position: absolute;\n  top: calc(var(--border) * 1);\n  right: calc(var(--border) * 1);\n  bottom: calc(var(--border) * 1);\n  left: calc(var(--border) * 1);\n  clip-path: var(--clip);\n  background: var(--primary);\n  z-index: -1;\n}\n\n@keyframes glitch {\n  0% {\n    clip-path: var(--clip-one);\n  }\n  2%,\n  8% {\n    clip-path: var(--clip-two);\n    transform: translate(calc(var(--shimmy-distance) * -1%), 0);\n  }\n  6% {\n    clip-path: var(--clip-two);\n    transform: translate(calc(var(--shimmy-distance) * 1%), 0);\n  }\n  9% {\n    clip-path: var(--clip-two);\n    transform: translate(0, 0);\n  }\n  10% {\n    clip-path: var(--clip-three);\n    transform: translate(calc(var(--shimmy-distance) * 1%), 0);\n  }\n  13% {\n    clip-path: var(--clip-three);\n    transform: translate(0, 0);\n  }\n  14%,\n  21% {\n    clip-path: var(--clip-four);\n    transform: translate(calc(var(--shimmy-distance) * 1%), 0);\n  }\n  25% {\n    clip-path: var(--clip-five);\n    transform: translate(calc(var(--shimmy-distance) * 1%), 0);\n  }\n  30% {\n    clip-path: var(--clip-five);\n    transform: translate(calc(var(--shimmy-distance) * -1%), 0);\n  }\n  35%,\n  45% {\n    clip-path: var(--clip-six);\n    transform: translate(calc(var(--shimmy-distance) * -1%));\n  }\n  40% {\n    clip-path: var(--clip-six);\n    transform: translate(calc(var(--shimmy-distance) * 1%));\n  }\n  50% {\n    clip-path: var(--clip-six);\n    transform: translate(0, 0);\n  }\n  55% {\n    clip-path: var(--clip-seven);\n    transform: translate(calc(var(--shimmy-distance) * 1%), 0);\n  }\n  60% {\n    clip-path: var(--clip-seven);\n    transform: translate(0, 0);\n  }\n  31%,\n  61%,\n  100% {\n    clip-path: var(--clip-four);\n  }\n}\n\n.cybr-btn:nth-of-type(2) {\n  --primary-hue: 260;\n}\n',""]);const o=i}}]);