"use strict";(self.webpackChunkpk_connect=self.webpackChunkpk_connect||[]).push([[28],{28:(e,n,t)=>{t.r(n),t.d(n,{bootstrap:()=>f,default:()=>d,mount:()=>v,unmount:()=>g});var o=t(861),c=t(885),a=t(757),r=t.n(a),s=t(271),u=t.n(s),i=t(650),l=t.n(i),p=t(577),h=t(788),m=t.n(h);function d(){var e=localStorage.getItem("token"),n=(0,s.useState)(e&&JSON.parse(e).value),t=(0,c.Z)(n,2),a=t[0],i=t[1],l=!1;return(0,s.useEffect)((0,o.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,fetch("https://pk-center.herokuapp.com/auth/reconnect",{method:"POST",headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){if(e.status>=400&&e.status<600)throw new Error("Bad response from server");return e})).catch((function(e){localStorage.removeItem("token"),i(null)}));case 4:case"end":return e.stop()}}),e)}))),[]),u().createElement(u().Fragment,null,a&&u().createElement("div",{className:"pkc-status"},"connected"),!a&&u().createElement("div",{className:"pkc-modal"},u().createElement("div",{className:"pkc-modal-overlay"}),u().createElement("div",{className:"pkc-modal-content"},u().createElement("button",{onClick:function(){l||(l=!0,fetch("https://pk-center.herokuapp.com/auth/guest",{method:"POST"}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("token",JSON.stringify({value:e.access_token})),i(e.access_token)})).finally((function(){l=!1})))}},"Play as guest"),u().createElement("button",{onClick:function(){location.href="https://pk.land/#/account/login"}},"Login PK account"))))}t(918),(0,p.Z)({seed:"pk-connect",productionPrefix:"pk-connect"});var k=m()({React:u(),ReactDOM:l(),rootComponent:d,errorBoundary:function(e,n,t){return u().createElement("div",null,"This renders when a catastrophic error occurs")}}),f=k.bootstrap,v=k.mount,g=k.unmount},279:(e,n,t)=>{t.d(n,{Z:()=>s});var o=t(81),c=t.n(o),a=t(645),r=t.n(a)()(c());r.push([e.id,".pkc-status {\n  color: lime;\n}\n.pkc-modal {\n  position: fixed;\n  z-index: 500;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n.pkc-modal-overlay {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n}\n.pkc-modal-content {\n  z-index: 1;\n  width: 300px;\n  height: 200px;\n}\n",""]);const s=r},918:(e,n,t)=>{var o=t(379),c=t.n(o),a=t(279);c()(a.Z,{insert:"head",singleton:!1}),a.Z.locals}}]);